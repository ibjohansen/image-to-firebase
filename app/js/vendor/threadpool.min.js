"function"!=typeof Worker&&console&&console.log("Warning: Browser does not support web workers.");
(function(){function k(a,c){if("function"!=typeof c)throw Error("Expected callback function as parameter.");for(var b=0;b<a.length;b++)if(a[b]==c)return;a.push(c)}function l(a,c){for(var b=0;b<a.length;b++)a[b].apply(null,c)}var p="data:text/javascript;charset=utf-8,"+encodeURI("this.onmessage = function (event) {    var fnData = event.data.function;    var scripts = event.data.importScripts;    var fn = Function.apply(null, fnData.args.concat(fnData.body));    if(importScripts && importScripts.length > 0) {        importScripts.apply(null, scripts);    }    fn(event.data.parameter, function(result) {        postMessage(result);    });}"),g=
    window.createBlobURL||window.createObjectURL;!g&&window.webkitURL&&(g=window.webkitURL.createObjectURL);if("function"==typeof BlobBuilder&&"function"==typeof g){var m=new BlobBuilder;m.append("this.onmessage = function (event) {    var fnData = event.data.function;    var scripts = event.data.importScripts;    var fn = Function.apply(null, fnData.args.concat(fnData.body));    if(importScripts && importScripts.length > 0) {        importScripts.apply(null, scripts);    }    fn(event.data.parameter, function(result) {        postMessage(result);    });}");
    p=g(m.getBlob())}else"function"==typeof Blob&&"function"==typeof g&&(m=new Blob(["this.onmessage = function (event) {    var fnData = event.data.function;    var scripts = event.data.importScripts;    var fn = Function.apply(null, fnData.args.concat(fnData.body));    if(importScripts && importScripts.length > 0) {        importScripts.apply(null, scripts);    }    fn(event.data.parameter, function(result) {        postMessage(result);    });}"],{type:"text/javascript"}),p=g(m));var n=function(a,c){this.param=
    c;this.importScripts=[];this.callbacksDone=[];this.callbacksError=[];if("function"==typeof a){var b=a.toString();this.scriptArgs=b.substring(b.indexOf("(")+1,b.indexOf(")")).split(",");this.scriptBody=b.substring(b.indexOf("{")+1,b.lastIndexOf("}"));this.scriptFile=void 0}else this.scriptBody=this.scriptArgs=void 0,this.scriptFile=a};n.prototype={getParameter:function(){return this.param},setParameter:function(a){this.param=a},getImportScripts:function(){return this.importScripts},setImportScripts:function(a){this.importScripts=
    a},getFunction:function(){return!this.scriptArgs?void 0:{args:this.scriptArgs,body:this.scriptBody}},getScriptFile:function(){return this.scriptFile},functionallyEquals:function(a){return a&&a instanceof n&&!(a.scriptArgs<this.scriptArgs||a.scriptArgs>this.scriptArgs)&&a.body==this.body&&a.scriptFile==this.scriptFile},triggerDone:function(a){l(this.callbacksDone,[a])},triggerError:function(a){l(this.callbacksError,[a])},done:function(a){k(this.callbacksDone,a);return this},error:function(a){k(this.callbacksError,
    a);return this}};var q=function(a){this.threadPool=a;this.lastJob=this.currentJob=this.worker=void 0};q.prototype={run:function(a){function c(a){d.currentJob.triggerDone(a.data);d.threadPool.triggerDone(a.data);e()}function b(a){d.currentJob.triggerError(a);d.threadPool.triggerError(a);e()}function e(){d.currentJob=void 0;d.lastJob=a;d.threadPool._threadDone(d)}var d=this,f=!0;this.currentJob=a;this.worker&&(this.lastJob&&this.lastJob.functionallyEquals(a)?f=!1:(this.worker.terminate(),this.worker=
    void 0));a.getScriptFile()?(f&&(this.worker=new Worker(a.getScriptFile()),this.worker.addEventListener("message",c,!1),this.worker.addEventListener("error",b,!1)),this.worker.postMessage(a.getParameter())):(f&&(this.worker=new Worker(p),this.worker.addEventListener("message",c,!1),this.worker.addEventListener("error",b,!1)),this.worker.postMessage({"function":a.getFunction(),importScripts:a.getImportScripts(),parameter:a.getParameter()}))}};var h=function(a){this.size=a=a||h.defaultSize;this.pendingJobs=
    [];this.idleThreads=[];this.callbacksDone=[];this.callbacksError=[];for(var c=0;c<a;c++)this.idleThreads.push(new q(this))};h.prototype={run:function(){var a=[].slice.call(arguments),c,b,e,d,f;if(1>arguments.length)throw Error("run(): Too less parameters.");if("string"==typeof a[0])c=a.shift();else if("object"==typeof a[0]&&a[0]instanceof Array&&(e=a.shift()),0<a.length&&"function"==typeof a[0])b=a.shift();else throw Error("run(): Missing obligatory thread logic function.");0<a.length&&"function"!=
    typeof a[0]&&(d=a.shift());0<a.length&&"function"==typeof a[0]&&(f=a.shift());if(0<a.length)throw Error("run(): Unrecognized parameters: "+a);c?a=new n(c,d):(a=new n(b,d),e&&0<e.length&&a.setImportScripts(e));f&&a.done(f);this.pendingJobs.push(a);this.runJobs();return a},runJobs:function(){if(0<this.idleThreads.length&&0<this.pendingJobs.length){var a=this.idleThreads.shift(),c=this.pendingJobs.shift();a.run(c)}},_threadDone:function(a){this.idleThreads.push(a);this.runJobs()},triggerDone:function(a){l(this.callbacksDone,
    [a])},triggerError:function(a){l(this.callbacksError,[a])},done:function(a){k(this.callbacksDone,a);return this},error:function(a){k(this.callbacksError,a);return this}};h.defaultSize=8;"function"==typeof define?define([],h):"object"==typeof window&&(window.ThreadPool=h)})();